<html>
<!--script type="text/javascript">
var gliEmbedDebug = true;
</script>
<script type="text/javascript" src="3rd/webgl-inspector/core/embed.js"></script-->
<script type="text/javascript" src="3rd/webgl-utils.js"></script>
<script type="text/javascript" src="3rd/glMatrix-0.9.5.min.js"></script>

<script type="text/javascript" src="crender.js"></script>
<script type="text/javascript" src="water.js"></script>

<script id="water-process-vs" type="x-shader/x-vertex"> 
attribute vec3 i_vertex;
varying vec2 v_texcrd;

void main(void) {
	gl_Position = vec4(i_vertex, 1.0);
	v_texcrd = i_vertex.xy * 0.5 + 0.5;
}
</script>

<script id="water-init-fs" type="x-shader/x-fragment"> 
precision highp float;
varying vec2 v_texcrd;

void main(void) {
	gl_FragColor.x = 0.0;
	gl_FragColor.y = 0.0;
	gl_FragColor.z = 0.0;
	gl_FragColor.w = 1.0;
}
</script>

<script id="water-draw-fs" type="x-shader/x-fragment"> 
precision highp float;
varying vec2 v_texcrd;

void main(void) {
	gl_FragColor.x = 0.0;
	gl_FragColor.y = 0.0;
	gl_FragColor.z = 0.0;
	gl_FragColor.w = 1.0;
}
</script>

<script type="text/javascript">

var water;

function log(x) {
	var logger = document.getElementById("logger");
	if(logger) {
		logger.innerHTML = logger.innerHTML + x + "\n";
	}
}

function init() {
	
	water = new Water(4, 4, 31);
	water.inited = false;
	
	crLog("init complete");
}

function render() {

	if(!water.inited) {
		water.init();
	}
}

function tick() {
	requestAnimFrame(tick);
	render();
}

function main() {
	crLog = log;
	var canvas = document.getElementById("the-canvas");
	crInit(canvas);
	init();
	tick();
}

</script>

<body onload="main();" style="background-color:#030303;color:#ffffff;">
<canvas id="the-canvas" style="border: none;" width="640" height="360"></canvas><br/>
Log<br/>
<textarea id="logger" rows="5" cols="80"></textarea>
</body>
</html>